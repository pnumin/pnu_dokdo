<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…ë„ ì—­ì‚¬ ì¸í„°ë™í‹°ë¸Œ ì—°ëŒ€ê¸° (Dokdo History Interactive Timeline)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F1F5F9; /* Slate 100 */
            color: #1E293B; /* Slate 800 */
        }

        /* Custom Scrollbar for Timeline */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 3px;
        }

        /* Chart Container Utilities */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Timeline Styles */
        .timeline-line {
            position: absolute;
            left: 24px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #E2E8F0;
            z-index: 0;
        }

        .timeline-node {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 3px solid #fff;
            position: absolute;
            left: 17px; /* (24px line center) - (16px width / 2) + adjustment */
            top: 24px;
            z-index: 10;
            box-shadow: 0 0 0 2px #E2E8F0;
            transition: all 0.3s ease;
        }

        .timeline-item-card {
            margin-left: 50px;
            transition: all 0.2s ease;
        }

        .timeline-row:hover .timeline-node {
            transform: scale(1.2);
        }

        .timeline-row.active .timeline-node {
            transform: scale(1.3);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3); /* Blue ring */
        }

        .timeline-row.active .timeline-item-card {
            background-color: #EFF6FF; /* Blue 50 */
            border-color: #3B82F6; /* Blue 500 */
            transform: translateX(4px);
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in-right {
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
    <!-- Chosen Palette: Slate & Ocean Blue with Era-specific Accents -->
    <!-- Application Structure Plan: 
         1. Interactive Dashboard: Charts providing context.
         2. Visual Timeline (Left): A vertical line connecting dots (years), replacing the simple list.
         3. Detail Viewer (Right): Deep dive into content with navigation controls.
         4. Interaction: Auto-play feature to walk through history automatically.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-100 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-20 border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white text-2xl shadow-lg">ğŸ‡°ğŸ‡·</div>
                <div>
                    <h1 class="text-xl font-bold text-slate-800 tracking-tight leading-none">ë…ë„ ì—­ì‚¬ ì—°ëŒ€ê¸°</h1>
                    <span class="text-xs text-blue-600 font-medium">Dokdo History Interactive Timeline</span>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <a href="index.html" class="flex items-center space-x-1 px-3 py-2 bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 hover:border-blue-300 hover:text-blue-600 rounded-full text-sm font-bold transition-all shadow-sm group">
                    <span class="group-hover:scale-110 transition-transform">ğŸ </span>
                    <span class="hidden sm:inline">í™ˆ</span>
                </a>
                <button onclick="toggleAutoPlay()" id="playBtn" class="flex items-center space-x-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-full text-sm font-bold transition-all shadow-md">
                    <span id="playIcon">â–¶</span>
                    <span id="playText">ì—­ì‚¬ ìë™ ì¬ìƒ</span>
                </button>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full space-y-6">

        <!-- Intro & Analytics Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Intro Text -->
            <section class="lg:col-span-1 bg-white rounded-2xl shadow-sm p-6 border border-slate-200 flex flex-col justify-center">
                <h2 class="text-2xl font-bold text-slate-800 mb-3">ğŸ” ì—­ì‚¬ì˜ ì§„ì‹¤ íƒêµ¬</h2>
                <p class="text-slate-600 text-sm leading-relaxed mb-4">
                    1454ë…„ ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€ë¶€í„° í˜„ëŒ€ì˜ ë¶„ìŸê¹Œì§€.<br>
                    <strong>ë…ë„ê°€ í•œêµ­ì˜ ê³ ìœ  ì˜í† </strong>ì„ì„ ì¦ëª…í•˜ëŠ” ê²°ì •ì  ì¦ê±°ë“¤ê³¼ ì¼ë³¸ì˜ ì£¼ì¥ ë³€í™” ê³¼ì •ì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•´ë³´ì„¸ìš”.
                </p>
                <div class="flex flex-wrap gap-2 text-xs font-medium">
                    <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded-md">ğŸ‡°ğŸ‡· í•œêµ­ ê¸°ë¡</span>
                    <span class="px-2 py-1 bg-emerald-100 text-emerald-700 rounded-md">ğŸ‡¯ğŸ‡µ ì¼ë³¸ ì¸ì •</span>
                    <span class="px-2 py-1 bg-red-100 text-red-700 rounded-md">âš ï¸ ë¶„ìŸ/ì´ìŠˆ</span>
                </div>
            </section>

            <!-- Chart 1: Type Analysis -->
            <section class="bg-white rounded-2xl shadow-sm p-4 border border-slate-200">
                <h3 class="text-sm font-bold text-slate-500 uppercase mb-2">ê¸°ë¡ ìœ í˜•ë³„ ë¶„í¬</h3>
                <div class="chart-container" style="height: 180px;">
                    <canvas id="typeChart"></canvas>
                </div>
            </section>
            
            <!-- Chart 2: Era Analysis -->
            <section class="bg-white rounded-2xl shadow-sm p-4 border border-slate-200">
                <h3 class="text-sm font-bold text-slate-500 uppercase mb-2">ì‹œëŒ€ë³„ ì‚¬ê±´ ë¹ˆë„</h3>
                <div class="chart-container" style="height: 180px;">
                    <canvas id="eraChart"></canvas>
                </div>
            </section>
        </div>

        <!-- Main Interactive Area -->
        <div class="flex flex-col lg:flex-row gap-6 h-[800px] lg:h-[650px]">
            
            <!-- LEFT: Visual Timeline Navigation -->
            <div class="lg:w-1/3 flex flex-col bg-white rounded-2xl shadow-md border border-slate-200 overflow-hidden relative">
                <!-- Timeline Header / Filters -->
                <div class="p-4 bg-slate-50 border-b border-slate-200 z-10 sticky top-0">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-slate-700">ì—°ëŒ€ê¸° ëª©ë¡</h3>
                        <span class="text-xs text-slate-400">ì´ <span id="totalCount">0</span>ê±´</span>
                    </div>
                    <div class="flex gap-1 overflow-x-auto pb-1 scrollbar-hide">
                        <button onclick="filterTimeline('all')" class="filter-btn active whitespace-nowrap px-3 py-1.5 rounded-full text-xs font-bold transition-colors bg-slate-800 text-white shadow-sm">ì „ì²´</button>
                        <button onclick="filterTimeline('korea')" class="filter-btn whitespace-nowrap px-3 py-1.5 rounded-full text-xs font-bold transition-colors bg-white text-slate-600 border border-slate-200 hover:text-blue-600 hover:border-blue-200">ğŸ‡°ğŸ‡· í•œêµ­ ê¸°ë¡</button>
                        <button onclick="filterTimeline('japan')" class="filter-btn whitespace-nowrap px-3 py-1.5 rounded-full text-xs font-bold transition-colors bg-white text-slate-600 border border-slate-200 hover:text-emerald-600 hover:border-emerald-200">ğŸ‡¯ğŸ‡µ ì¼ë³¸ ì¸ì •</button>
                        <button onclick="filterTimeline('conflict')" class="filter-btn whitespace-nowrap px-3 py-1.5 rounded-full text-xs font-bold transition-colors bg-white text-slate-600 border border-slate-200 hover:text-red-600 hover:border-red-200">âš ï¸ ë¶„ìŸ/ì´ìŠˆ</button>
                    </div>
                </div>

                <!-- Timeline Body -->
                <div id="timelineContainer" class="flex-grow overflow-y-auto custom-scrollbar relative bg-white">
                    <div class="timeline-line h-full"></div> <!-- Vertical Line -->
                    <div id="timelineList" class="py-6 pr-4">
                        <!-- Content populated by JS -->
                    </div>
                </div>
            </div>

            <!-- RIGHT: Detail View Board -->
            <div class="lg:w-2/3 flex flex-col">
                <div class="flex-grow bg-white rounded-2xl shadow-lg border border-slate-200 p-8 relative flex flex-col overflow-hidden">
                    
                    <!-- Background Watermark Year -->
                    <div id="bgYear" class="absolute top-0 right-0 text-[120px] sm:text-[200px] font-black text-slate-100 select-none pointer-events-none -mt-10 -mr-10 transition-all duration-500">
                        1454
                    </div>

                    <div id="contentState" class="relative z-10 flex flex-col h-full fade-in">
                        <!-- Top Badges -->
                        <div class="flex items-center space-x-2 mb-6">
                            <span id="detailBadge" class="px-3 py-1 rounded-full text-sm font-bold bg-blue-600 text-white shadow-sm">
                                ê´€ì°¬ ê¸°ë¡
                            </span>
                            <span id="detailCat" class="text-sm font-medium text-slate-500">
                                í•œêµ­ ì¸¡ ì‚¬ë£Œ
                            </span>
                        </div>

                        <!-- Main Title Area -->
                        <div class="mb-8">
                            <div class="text-5xl font-black text-slate-800 mb-2 tracking-tight" id="detailYearText">1454</div>
                            <h2 id="detailTitle" class="text-3xl md:text-4xl font-bold text-slate-900 leading-tight">
                                ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€
                            </h2>
                        </div>

                        <!-- Description Box -->
                        <div class="flex-grow">
                            <div class="bg-slate-50 border-l-4 border-slate-300 p-6 rounded-r-xl mb-6">
                                <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">ë‚´ìš© ë° ì—­ì‚¬ì  ì˜ë¯¸</h4>
                                <p id="detailDesc" class="text-lg md:text-xl text-slate-700 leading-relaxed font-medium">
                                    ìš°ì‚°(ë…ë„)ê³¼ ë¬´ë¦‰(ìš¸ë¦‰ë„)ì´ ê°•ì›ë„ ìš¸ì§„í˜„ì— ì†í•œë‹¤ê³  ê¸°ë¡í•¨. ë…ë„ê°€ í•œêµ­ ì˜í† ì„ì„ ë°íŒ ì´ˆê¸° ê´€ì°¬ ê¸°ë¡.
                                </p>
                            </div>
                        </div>

                        <!-- Source Footnote -->
                        <div class="mt-4 pt-4 border-t border-slate-100 flex justify-between items-center text-slate-400 text-sm">
                            <div class="flex items-center">
                                <span class="mr-2">ğŸ“š</span>
                                <span>ì¶œì²˜: <span id="detailSource" class="font-mono text-slate-600">[1]</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom Navigation Controls -->
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <button onclick="navStep(-1)" class="group bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:border-blue-300 hover:shadow-md transition-all flex items-center justify-start text-left">
                        <div class="w-10 h-10 rounded-full bg-slate-100 group-hover:bg-blue-50 text-slate-400 group-hover:text-blue-600 flex items-center justify-center mr-3 transition-colors text-xl">â†</div>
                        <div>
                            <span class="block text-xs text-slate-400 font-bold uppercase">ì´ì „ ì‚¬ê±´</span>
                            <span class="text-sm font-bold text-slate-700 truncate w-32 md:w-48 block" id="prevTitle">ì—†ìŒ</span>
                        </div>
                    </button>

                    <button onclick="navStep(1)" class="group bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:border-blue-300 hover:shadow-md transition-all flex items-center justify-end text-right">
                        <div>
                            <span class="block text-xs text-slate-400 font-bold uppercase">ë‹¤ìŒ ì‚¬ê±´</span>
                            <span class="text-sm font-bold text-slate-700 truncate w-32 md:w-48 block" id="nextTitle">ì‹ ì¦ë™êµ­ì—¬ì§€ìŠ¹ëŒ</span>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-slate-100 group-hover:bg-blue-50 text-slate-400 group-hover:text-blue-600 flex items-center justify-center ml-3 transition-colors text-xl">â†’</div>
                    </button>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- DATA ---
        const timelineData = [
            { id: 1, year: 1454, title: "ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€", category: "korea", type: "ê´€ì°¬ ê¸°ë¡", desc: "ìš°ì‚°(ë…ë„)ê³¼ ë¬´ë¦‰(ìš¸ë¦‰ë„)ì´ ê°•ì›ë„ ìš¸ì§„í˜„ì— ì†í•œë‹¤ê³  ê¸°ë¡í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŠ” ë…ë„ê°€ í•œêµ­ ì˜í† ì„ì„ ë°íŒ ì´ˆê¸° ì •ë¶€ ê³µì‹ ê¸°ë¡ìœ¼ë¡œì„œ ë§¤ìš° ì¤‘ìš”í•œ ì—­ì‚¬ì  ê°€ì¹˜ë¥¼ ì§€ë‹™ë‹ˆë‹¤.", source: "[1]" },
            { id: 2, year: 1531, title: "ì‹ ì¦ë™êµ­ì—¬ì§€ìŠ¹ëŒ", category: "korea", type: "ê´€ì°¬ ê¸°ë¡", desc: "ë…ë„ê°€ ìš°ë¦¬ ì˜í† ì„ì„ ëª…í™•íˆ ë°íˆëŠ” ê´€ì°¬ ì§€ë¦¬ì§€ì…ë‹ˆë‹¤. íŒ”ë„ì´ë„ì— ë…ë„ê°€ ìš°ì‚°ë„ë¡œ í‘œê¸°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.", source: "[2]" },
            { id: 3, year: 1667, title: "ì€ì£¼ì‹œì²­í•©ê¸°", category: "japan", type: "ì¼ë³¸ ë¬¸í—Œ", desc: "ì¼ë³¸ì˜ ê´€ë¦¬ê°€ ì €ìˆ í•œ ë¬¸í—Œìœ¼ë¡œ, ìš¸ë¦‰ë„ì™€ ë…ë„ê°€ ì¼ë³¸ ì˜í†  ë°–(ì¡°ì„  ë•…)ì„ì„ ìŠ¤ìŠ¤ë¡œ ê¸°ë¡í•˜ê³  ìˆì–´ ì¼ë³¸ ì£¼ì¥ì˜ í—ˆêµ¬ì„±ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.", source: "[3]" },
            { id: 4, year: 1693, title: "1ì°¨ ì•ˆìš©ë³µ ì‚¬ê±´", category: "korea", type: "ë¯¼ê°„ í™œë™", desc: "ì•ˆìš©ë³µì´ ì¼ë³¸ìœ¼ë¡œ ëŒë ¤ê°”ìœ¼ë‚˜ êµ´í•˜ì§€ ì•Šê³  ë…ë„ê°€ ì¡°ì„  ë•…ì„ì„ ê°•ë ¥íˆ ì£¼ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.", source: "[4]" },
            { id: 5, year: 1696, title: "2ì°¨ ì•ˆìš©ë³µ ì‚¬ê±´", category: "korea", type: "ë¯¼ê°„ í™œë™", desc: "ì•ˆìš©ë³µì´ ë‹¤ì‹œ ì¼ë³¸ì— ê±´ë„ˆê°€ ì–´ë¯¼ë“¤ì˜ ë¶ˆë²• ì¹¨ë²”ì— í•­ì˜í–ˆìŠµë‹ˆë‹¤. ì´ì— ì¼ë³¸ ë§‰ë¶€ëŠ” 'ìš¸ë¦‰ë„ ë„í•´ ê¸ˆì§€ë ¹'ì„ ë‚´ë ¸ìŠµë‹ˆë‹¤.", source: "[5]" },
            { id: 6, year: 1785, title: "ì‚¼êµ­ì ‘ì–‘ì§€ë„", category: "japan", type: "ì¼ë³¸ ì§€ë„", desc: "ì¼ë³¸ í•™ì í•˜ì•¼ì‹œ ì‹œí—¤ì´ê°€ ì œì‘í•œ ì§€ë„ì…ë‹ˆë‹¤. ë…ë„ë¥¼ ì¡°ì„ ìƒ‰(í™©ìƒ‰)ìœ¼ë¡œ ì¹ í•˜ê³  ì˜†ì— 'ì¡°ì„ ì˜ ê²ƒ'ì´ë¼ ëª…í™•íˆ í‘œê¸°í–ˆìŠµë‹ˆë‹¤.", source: "[6]" },
            { id: 7, year: 1877, title: "íƒœì •ê´€ ì§€ë ¹", category: "japan", type: "ì¼ë³¸ ê³µë¬¸ì„œ", desc: "ë‹¹ì‹œ ì¼ë³¸ ìµœê³  í–‰ì •ê¸°ê´€ì¸ íƒœì •ê´€ì´ 'ë…ë„ì™€ ìš¸ë¦‰ë„ëŠ” ì¼ë³¸ê³¼ ê´€ê³„ì—†ë‹¤'ê³  ë‚´ë¬´ì„±ì— ë‚´ë¦° ê³µì‹ ì§€ë ¹ì…ë‹ˆë‹¤. ì¼ë³¸ ìŠ¤ìŠ¤ë¡œ ì˜ìœ ê¶Œì„ ë¶€ì •í•œ ê²°ì •ì  ì¦ê±°ì…ë‹ˆë‹¤.", source: "[7]" },
            { id: 8, year: 1900, title: "ëŒ€í•œì œêµ­ ì¹™ë ¹ 41í˜¸", category: "korea", type: "ë²•ë ¹", desc: "ê³ ì¢… í™©ì œê°€ ë…ë„ë¥¼ ìš¸ë¦‰êµ°ì˜ ê´€í•  êµ¬ì—­ìœ¼ë¡œ ê³µì‹ ë°˜í¬í•˜ì—¬ ê·¼ëŒ€ë²•ì ìœ¼ë¡œ ì˜í†  ì£¼ê¶Œì„ ì¬í™•ì¸í–ˆìŠµë‹ˆë‹¤.", source: "[8]" },
            { id: 9, year: 1905, title: "ì‹œë§ˆë„¤í˜„ ê³ ì‹œ 40í˜¸", category: "conflict", type: "ì¼ë³¸ ë„ë°œ", desc: "ì¼ë³¸ì´ ëŸ¬ì¼ì „ìŸ ì¤‘ êµ°ì‚¬ì  ëª©ì ìœ¼ë¡œ ë…ë„ë¥¼ ì£¼ì¸ ì—†ëŠ” ë•…ì´ë¼ ì£¼ì¥í•˜ë©° ë¶ˆë²•ì ìœ¼ë¡œ 'ë‹¤ì¼€ì‹œë§ˆ'ë¡œ í¸ì…ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤.", source: "[9]" },
            { id: 10, year: 1906, title: "ì‹¬í¥íƒ ë³´ê³ ì„œ", category: "korea", type: "ë³´ê³ ì„œ", desc: "ìš¸ë¦‰êµ°ìˆ˜ ì‹¬í¥íƒì´ ë…ë„ê°€ ì¼ë³¸ì— ë¶ˆë²• í¸ì…ë˜ì—ˆë‹¤ëŠ” ì†Œì‹ì„ ë“£ê³  ì¦‰ê° ì¤‘ì•™ ì •ë¶€ì— ë³´ê³ í•˜ì—¬ ë¶€ë‹¹í•¨ì„ ì•Œë ¸ìŠµë‹ˆë‹¤.", source: "[8]" },
            { id: 11, year: 1946, title: "SCAPIN ì œ677í˜¸", category: "intl", type: "êµ­ì œ ì§€ë ¹", desc: "ì—°í•©êµ°ìµœê³ ì‚¬ë ¹ê´€ ì§€ë ¹ìœ¼ë¡œ ë…ë„ë¥¼ ì¼ë³¸ì˜ í†µì¹˜ê¶Œ ë° ì˜í† ì—ì„œ ê³µì‹ì ìœ¼ë¡œ ì œì™¸í•œë‹¤ê³  ëª…ì‹œí–ˆìŠµë‹ˆë‹¤.", source: "[10]" },
            { id: 12, year: 1951, title: "ìƒŒí”„ë€ì‹œìŠ¤ì½” ê°•í™”ì¡°ì•½", category: "intl", type: "êµ­ì œ ì¡°ì•½", desc: "ì¼ë³¸ì´ í•œêµ­ì˜ ë…ë¦½ì„ ì¸ì •í–ˆìœ¼ë‚˜, ë¯¸êµ­ì˜ ì˜í–¥ìœ¼ë¡œ ì¡°ì•½ë¬¸ì— ë…ë„ê°€ ëª…ì‹œì ìœ¼ë¡œ í¬í•¨ë˜ì§€ ì•Šì•„ ì´í›„ ë¶„ìŸì˜ ì”¨ì•—ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", source: "[11]" },
            { id: 13, year: 1952, title: "í‰í™”ì„  ì„ í¬", category: "korea", type: "ëŒ€í†µë ¹ ì„ ì–¸", desc: "ì´ìŠ¹ë§Œ ëŒ€í†µë ¹ì´ ë…ë„ë¥¼ í¬í•¨í•œ ì¸ì ‘ í•´ì–‘ì— ëŒ€í•œ ì£¼ê¶Œì„ ì„ ì–¸(í‰í™”ì„ )í•˜ì—¬ ë…ë„ ìˆ˜í˜¸ ì˜ì§€ë¥¼ ëŒ€ë‚´ì™¸ì— ì²œëª…í–ˆìŠµë‹ˆë‹¤.", source: "[12]" },
            { id: 14, year: 1953, title: "ë…ë„ì˜ìš©ìˆ˜ë¹„ëŒ€ í™œë™", category: "korea", type: "ë¯¼ê°„ ìˆ˜í˜¸", desc: "í™ìˆœì¹  ëŒ€ì¥ ë“± ë¯¼ê°„ì¸ë“¤ì´ ìë°œì ìœ¼ë¡œ ë¬´ì¥í•˜ì—¬ ë…ë„ì— ìƒì£¼í•˜ë©° 3ë…„ 8ê°œì›”ê°„ ì¼ë³¸ì˜ ì¹¨ë²”ì„ ë§‰ì•„ëƒˆìŠµë‹ˆë‹¤.", source: "[13], [14]" },
            { id: 15, year: 1965, title: "í•œì¼ê¸°ë³¸ì¡°ì•½", category: "intl", type: "êµ­ì œ ì¡°ì•½", desc: "í•œì¼ êµ­êµ ì •ìƒí™” ê³¼ì •ì—ì„œ ë…ë„ ë¬¸ì œë¥¼ ì§ì ‘ ì–¸ê¸‰í•˜ì§€ ì•Šê³  ë¯¸í•´ê²° ìƒíƒœë¡œ ë´‰í•©í•˜ì—¬ ì´í›„ ê°ˆë“±ì´ ì ë³µë˜ëŠ” ì›ì¸ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", source: "[15]" },
            { id: 16, year: 1998, title: "ì‹ í•œì¼ì–´ì—…í˜‘ì •", category: "conflict", type: "êµ­ì œ í˜‘ì •", desc: "ë…ë„ê°€ í•œì¼ ì¤‘ê°„ìˆ˜ì—­ì— í¬í•¨ë˜ë©´ì„œ ì˜ìœ ê¶Œ ë° ì–´ì—…ê¶Œê³¼ ê´€ë ¨í•´ êµ­ë‚´ì™¸ì ìœ¼ë¡œ í° ë…¼ë€ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", source: "[16]" },
            { id: 17, year: 2005, title: "ë‹¤ì¼€ì‹œë§ˆì˜ ë‚  ì œì •", category: "conflict", type: "ì¼ë³¸ ë„ë°œ", desc: "ì¼ë³¸ ì‹œë§ˆë„¤í˜„ ì˜íšŒê°€ 2ì›” 22ì¼ì„ ë©‹ëŒ€ë¡œ 'ë‹¤ì¼€ì‹œë§ˆì˜ ë‚ 'ë¡œ ì œì •í•˜ì—¬ ì˜ìœ ê¶Œ ë„ë°œì„ ë…¸ê³¨í™”í–ˆìŠµë‹ˆë‹¤.", source: "[17]" },
            { id: 18, year: 2011, title: "ì¼ë³¸ êµê³¼ì„œ ì™œê³¡", category: "conflict", type: "ì—­ì‚¬ ì™œê³¡", desc: "ì¼ë³¸ ì¤‘í•™êµ ì‚¬íšŒê³¼ êµê³¼ì„œ ëŒ€ë¶€ë¶„ì— ë…ë„ ì˜ìœ ê¶Œ ì£¼ì¥ì´ ê¸°ìˆ ë˜ê¸° ì‹œì‘í•˜ë©° ì—­ì‚¬ ì™œê³¡ êµìœ¡ì´ ì‹¬í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", source: "[18]" }
        ];

        // --- STATE MANAGEMENT ---
        let currentFilter = 'all';
        let selectedId = 1;
        let isPlaying = false;
        let playInterval;
        let filteredIds = timelineData.map(d => d.id); // Currently visible IDs

        // --- DOM ELEMENTS ---
        const listContainer = document.getElementById('timelineList');
        const detailYearText = document.getElementById('detailYearText');
        const bgYear = document.getElementById('bgYear');
        const detailTitle = document.getElementById('detailTitle');
        const detailDesc = document.getElementById('detailDesc');
        const detailSource = document.getElementById('detailSource');
        const detailBadge = document.getElementById('detailBadge');
        const detailCat = document.getElementById('detailCat');
        const contentState = document.getElementById('contentState');
        const totalCountEl = document.getElementById('totalCount');
        const btns = document.querySelectorAll('.filter-btn');
        const timelineContainer = document.getElementById('timelineContainer');
        const prevTitleEl = document.getElementById('prevTitle');
        const nextTitleEl = document.getElementById('nextTitle');

        // --- UTILS ---
        function getCategoryStyle(category) {
            switch(category) {
                case 'korea': return { dot: 'border-blue-500 bg-white', badge: 'bg-blue-600 text-white', label: 'ğŸ‡°ğŸ‡· í•œêµ­ ê¸°ë¡/í™œë™' };
                case 'japan': return { dot: 'border-emerald-500 bg-white', badge: 'bg-emerald-600 text-white', label: 'ğŸ‡¯ğŸ‡µ ì¼ë³¸ ì¸ì •/ê¸°ë¡' };
                case 'conflict': return { dot: 'border-red-500 bg-white', badge: 'bg-red-600 text-white', label: 'âš ï¸ ë¶„ìŸ/ë„ë°œ' };
                case 'intl': return { dot: 'border-purple-500 bg-white', badge: 'bg-purple-600 text-white', label: 'ğŸŒ êµ­ì œ ì¡°ì•½' };
                default: return { dot: 'border-slate-400 bg-white', badge: 'bg-slate-600 text-white', label: 'ê¸°íƒ€' };
            }
        }

        // --- RENDER TIMELINE LIST ---
        function renderTimeline(filter) {
            listContainer.innerHTML = '';
            
            const filteredData = filter === 'all' 
                ? timelineData 
                : timelineData.filter(item => {
                    if (filter === 'conflict') return item.category === 'conflict' || (item.year >= 1950 && item.category === 'intl');
                    return item.category === filter;
                });

            filteredIds = filteredData.map(d => d.id);
            totalCountEl.innerText = filteredData.length;

            if (filteredData.length === 0) {
                listContainer.innerHTML = '<div class="pl-12 py-4 text-slate-400 text-sm">í•´ë‹¹í•˜ëŠ” ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            filteredData.forEach(item => {
                const style = getCategoryStyle(item.category);
                const isActive = item.id === selectedId;
                
                const row = document.createElement('div');
                row.className = `timeline-row relative py-2 pr-2 cursor-pointer group ${isActive ? 'active' : ''}`;
                row.onclick = () => selectEvent(item.id);
                row.id = `timeline-item-${item.id}`;

                row.innerHTML = `
                    <!-- Dot on Line -->
                    <div class="timeline-node ${style.dot} ${isActive ? 'bg-slate-100' : ''}"></div>
                    
                    <!-- Content Card -->
                    <div class="timeline-item-card p-3 rounded-lg border border-transparent hover:bg-slate-50 hover:border-slate-200 hover:shadow-sm">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-xs font-black text-slate-400 font-mono">${item.year}</span>
                            ${isActive ? '<span class="text-[10px] px-1.5 py-0.5 rounded bg-blue-100 text-blue-700 font-bold">ì„ íƒë¨</span>' : ''}
                        </div>
                        <h4 class="font-bold text-slate-700 text-sm leading-tight group-hover:text-blue-700 transition-colors">${item.title}</h4>
                    </div>
                `;
                listContainer.appendChild(row);
            });

            updateNavButtons();
        }

        function selectEvent(id, scroll = false) {
            if (!timelineData.find(d => d.id === id)) return;
            
            selectedId = id;
            
            // Re-render list to update active styling
            renderTimeline(currentFilter);
            
            // Scroll selected item into view in the list
            if (scroll) {
                const el = document.getElementById(`timeline-item-${id}`);
                if (el) {
                    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            updateDetailView();
        }

        function updateDetailView() {
            const item = timelineData.find(d => d.id === selectedId);
            if (!item) return;

            const style = getCategoryStyle(item.category);

            // Animate content refresh
            contentState.classList.remove('fade-in', 'slide-in-right');
            void contentState.offsetWidth; // Force reflow
            contentState.classList.add('fade-in', 'slide-in-right');

            // Update Text Content
            detailYearText.innerText = item.year;
            bgYear.innerText = item.year;
            detailTitle.innerText = item.title;
            detailDesc.innerHTML = item.desc; // Using innerHTML for potential highlighting
            detailSource.innerText = item.source;
            
            // Styles
            detailBadge.className = `px-3 py-1 rounded-full text-sm font-bold shadow-sm ${style.badge}`;
            detailBadge.innerText = item.type;
            detailCat.innerText = style.label;
        }

        // --- NAVIGATION & INTERACTION ---
        function filterTimeline(category) {
            currentFilter = category;
            
            // Visual Update for Tabs
            btns.forEach(btn => {
                const isSelected = btn.getAttribute('onclick').includes(`'${category}'`);
                if (isSelected) {
                    btn.className = "filter-btn active whitespace-nowrap px-3 py-1.5 rounded-full text-xs font-bold transition-colors bg-slate-800 text-white shadow-sm";
                } else {
                    const baseClass = "filter-btn whitespace-nowrap px-3 py-1.5 rounded-full text-xs font-bold transition-colors bg-white text-slate-600 border border-slate-200";
                    // Restore hover colors based on original intent (simplified here)
                    btn.className = baseClass + " hover:bg-slate-50"; 
                }
            });

            // Logic: Select first visible item if current selection is hidden
            const visibleItems = category === 'all' 
                ? timelineData 
                : timelineData.filter(item => {
                     if (category === 'conflict') return item.category === 'conflict' || (item.year >= 1950 && item.category === 'intl');
                     return item.category === category;
                });
            
            if (visibleItems.length > 0) {
                const currentIsVisible = visibleItems.find(d => d.id === selectedId);
                if (!currentIsVisible) {
                    selectEvent(visibleItems[0].id, true);
                } else {
                    renderTimeline(category); // Just re-render list
                }
            } else {
                renderTimeline(category);
            }
        }

        function updateNavButtons() {
            const currentIndex = filteredIds.indexOf(selectedId);
            
            // Prev Button
            if (currentIndex > 0) {
                const prevId = filteredIds[currentIndex - 1];
                const prevItem = timelineData.find(d => d.id === prevId);
                prevTitleEl.innerText = `${prevItem.year} ${prevItem.title}`;
                prevTitleEl.parentElement.parentElement.disabled = false;
                prevTitleEl.parentElement.parentElement.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                prevTitleEl.innerText = "ì´ì „ ì—†ìŒ";
                prevTitleEl.parentElement.parentElement.disabled = true;
                prevTitleEl.parentElement.parentElement.classList.add('opacity-50', 'cursor-not-allowed');
            }

            // Next Button
            if (currentIndex < filteredIds.length - 1) {
                const nextId = filteredIds[currentIndex + 1];
                const nextItem = timelineData.find(d => d.id === nextId);
                nextTitleEl.innerText = `${nextItem.year} ${nextItem.title}`;
                nextTitleEl.parentElement.parentElement.disabled = false;
                nextTitleEl.parentElement.parentElement.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                nextTitleEl.innerText = "ë§ˆì§€ë§‰ ê¸°ë¡";
                nextTitleEl.parentElement.parentElement.disabled = true;
                nextTitleEl.parentElement.parentElement.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        function navStep(step) {
            const currentIndex = filteredIds.indexOf(selectedId);
            const nextIndex = currentIndex + step;

            if (nextIndex >= 0 && nextIndex < filteredIds.length) {
                selectEvent(filteredIds[nextIndex], true);
            } else if (isPlaying && step === 1) {
                // Loop back to start if auto-playing
                selectEvent(filteredIds[0], true);
            }
        }

        // --- AUTOPLAY ---
        function toggleAutoPlay() {
            const btn = document.getElementById('playBtn');
            const icon = document.getElementById('playIcon');
            const text = document.getElementById('playText');

            if (isPlaying) {
                // Stop
                clearInterval(playInterval);
                isPlaying = false;
                btn.classList.remove('bg-red-600', 'hover:bg-red-700');
                btn.classList.add('bg-slate-800', 'hover:bg-slate-700');
                icon.innerText = "â–¶";
                text.innerText = "ì—­ì‚¬ ìë™ ì¬ìƒ";
            } else {
                // Start
                isPlaying = true;
                btn.classList.remove('bg-slate-800', 'hover:bg-slate-700');
                btn.classList.add('bg-red-600', 'hover:bg-red-700');
                icon.innerText = "â¸";
                text.innerText = "ì¬ìƒ ì¤‘ì§€";
                
                // Immediate step if at end
                const currentIndex = filteredIds.indexOf(selectedId);
                if (currentIndex === filteredIds.length - 1) {
                    selectEvent(filteredIds[0], true);
                }

                playInterval = setInterval(() => {
                    navStep(1);
                }, 3000); // 3 seconds per slide
            }
        }

        // --- CHARTS ---
        function initCharts() {
            // Data Prep
            const typeCounts = { 'korea': 0, 'japan': 0, 'conflict': 0, 'intl': 0 };
            const eraCounts = {
                'ì¡°ì„ ì‹œëŒ€\n(1392~1897)': 0,
                'ëŒ€í•œì œêµ­/ì¼ì œê°•ì ê¸°\n(1897~1945)': 0,
                'ê´‘ë³µ ì´í›„\n(1945~)': 0
            };

            timelineData.forEach(item => {
                if (typeCounts[item.category] !== undefined) typeCounts[item.category]++;
                
                if (item.year < 1897) eraCounts['ì¡°ì„ ì‹œëŒ€\n(1392~1897)']++;
                else if (item.year <= 1945) eraCounts['ëŒ€í•œì œêµ­/ì¼ì œê°•ì ê¸°\n(1897~1945)']++;
                else eraCounts['ê´‘ë³µ ì´í›„\n(1945~)']++;
            });

            // Chart Defaults
            Chart.defaults.font.family = "'Noto Sans KR', sans-serif";
            Chart.defaults.font.size = 11;

            // Chart 1: Types (Bar)
            new Chart(document.getElementById('typeChart').getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['í•œêµ­ ê¸°ë¡', 'ì¼ë³¸ ì¸ì •', 'êµ­ì œ ì¡°ì•½', 'ë¶„ìŸ/ë„ë°œ'],
                    datasets: [{
                        data: [typeCounts.korea, typeCounts.japan, typeCounts.intl, typeCounts.conflict],
                        backgroundColor: ['#2563EB', '#10B981', '#9333EA', '#EF4444'],
                        borderRadius: 4,
                        barThickness: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { display: false, grid: { display: false } },
                        x: { grid: { display: false } }
                    },
                    animation: { duration: 1500 }
                }
            });

            // Chart 2: Eras (Doughnut)
            new Chart(document.getElementById('eraChart').getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(eraCounts),
                    datasets: [{
                        data: Object.values(eraCounts),
                        backgroundColor: ['#D97706', '#64748B', '#2563EB'],
                        borderWidth: 0,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { boxWidth: 10, padding: 10 } }
                    },
                    cutout: '70%',
                    animation: { animateScale: true, animateRotate: true }
                }
            });
        }

        // --- INIT ---
        window.onload = function() {
            renderTimeline('all');
            updateDetailView();
            initCharts();
        };

    </script>
</body>
</html>
